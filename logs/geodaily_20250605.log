2025-06-05 17:38:08,052 - test_rss - INFO - Testing RSS collection with BBC World feed...
2025-06-05 17:38:08,155 - test_rss - INFO - Collected 33 articles
2025-06-05 17:38:08,155 - test_rss - INFO - Sample article:
2025-06-05 17:38:08,156 - test_rss - INFO -   Title: Trump 'very disappointed' by Musk as row explodes into public
2025-06-05 17:38:08,156 - test_rss - INFO -   URL: https://www.bbc.com/news/articles/c5yg98rl717o
2025-06-05 17:38:08,156 - test_rss - INFO -   Summary: In response, Musk accused the president of "Such ingratitude", adding: "Without me, Trump would have...
2025-06-05 17:38:08,156 - test_rss - INFO -   Published: 2025-06-05 17:09:55+00:00
2025-06-05 17:38:08,156 - test_rss - INFO -   Source: BBC World
2025-06-05 18:08:51,026 - test_collection - INFO - === Testing Article Collection ===
2025-06-05 18:08:58,609 - test_collection - INFO - Collection results:
2025-06-05 18:08:58,610 - test_collection - INFO -   - Total articles: 479
2025-06-05 18:08:58,610 - test_collection - INFO -   - Collection time: 7.58s
2025-06-05 18:08:58,610 - test_collection - INFO -   - Errors: 0
2025-06-05 18:08:58,610 - test_collection - INFO - Sample articles:
2025-06-05 18:08:58,610 - test_collection - INFO -   1. Dehorning rhinos reduces poaching by 80%, study finds
2025-06-05 18:08:58,610 - test_collection - INFO -      Source: Guardian International
2025-06-05 18:08:58,610 - test_collection - INFO -      Category: mainstream
2025-06-05 18:08:58,610 - test_collection - INFO -      URL: https://www.theguardian.com/environment/2025/jun/05/dehorning-rhinos-deters-poachers-rangers-helicopters-aoe
2025-06-05 18:08:58,610 - test_collection - INFO - 
2025-06-05 18:08:58,610 - test_collection - INFO -   2. Idris Elba: ‘I want to build the African Odeon’
2025-06-05 18:08:58,610 - test_collection - INFO -      Source: Guardian International
2025-06-05 18:08:58,610 - test_collection - INFO -      Category: mainstream
2025-06-05 18:08:58,610 - test_collection - INFO -      URL: https://www.theguardian.com/film/2025/jun/05/idris-elba-i-want-to-build-the-african-odeon
2025-06-05 18:08:58,610 - test_collection - INFO - 
2025-06-05 18:08:58,610 - test_collection - INFO -   3. Venezuela says being in US is ‘great risk’ as countries respond to Trump travel ban
2025-06-05 18:08:58,610 - test_collection - INFO -      Source: Guardian International
2025-06-05 18:08:58,610 - test_collection - INFO -      Category: mainstream
2025-06-05 18:08:58,610 - test_collection - INFO -      URL: https://www.theguardian.com/us-news/2025/jun/05/venezuela-warns-us-is-dangerous-anyway-in-trump-travel-ban-retort
2025-06-05 18:08:58,610 - test_collection - INFO - 
2025-06-05 18:09:54,019 - test_dedup - INFO - === Testing Article Deduplication ===
2025-06-05 18:09:54,019 - test_dedup - INFO - Step 1: Collecting articles...
2025-06-05 18:10:00,673 - test_dedup - INFO - Collected 479 raw articles
2025-06-05 18:10:00,673 - test_dedup - INFO - Step 2: Testing deduplication...
2025-06-05 18:10:14,441 - test_dedup - INFO - Deduplication results:
2025-06-05 18:10:14,441 - test_dedup - INFO -   - Original articles: 479
2025-06-05 18:10:14,441 - test_dedup - INFO -   - Unique articles: 472
2025-06-05 18:10:14,441 - test_dedup - INFO -   - Deduplication rate: 1.46%
2025-06-05 18:10:14,441 - test_dedup - INFO - Step 3: Testing clustering...
2025-06-05 18:10:14,572 - test_dedup - INFO - Clustering results:
2025-06-05 18:10:14,573 - test_dedup - INFO -   - Input articles: 50
2025-06-05 18:10:14,573 - test_dedup - INFO -   - Clusters created: 50
2025-06-05 18:10:14,573 - test_dedup - INFO - Sample clusters:
2025-06-05 18:10:14,573 - test_dedup - INFO -   1. Cluster cluster_0 (score: 1.90)
2025-06-05 18:10:14,573 - test_dedup - INFO -      Main article: Europe Doesn’t Have a China Card
2025-06-05 18:10:14,573 - test_dedup - INFO -      Articles in cluster: 1
2025-06-05 18:10:14,573 - test_dedup - INFO - 
2025-06-05 18:10:14,573 - test_dedup - INFO -   2. Cluster cluster_1 (score: 1.90)
2025-06-05 18:10:14,573 - test_dedup - INFO -      Main article: America and Israel Follow the Same Old Script
2025-06-05 18:10:14,573 - test_dedup - INFO -      Articles in cluster: 1
2025-06-05 18:10:14,573 - test_dedup - INFO - 
2025-06-05 18:10:14,573 - test_dedup - INFO -   3. Cluster cluster_2 (score: 1.40)
2025-06-05 18:10:14,573 - test_dedup - INFO -      Main article: Putin’s Pressure Point
2025-06-05 18:10:14,573 - test_dedup - INFO -      Articles in cluster: 1
2025-06-05 18:10:14,573 - test_dedup - INFO - 
2025-06-05 18:11:53,021 - test_ai_mock - INFO - === Testing AI Analyzer Structure ===
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Step 1: Creating mock clusters...
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Created 3 mock clusters
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Step 2: Testing cluster summary preparation...
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Generated 3 cluster summaries
2025-06-05 18:11:53,021 - test_ai_mock - INFO -   - China's New Arctic Strategy Threatens NATO Supply Lines (score: 8.50)
2025-06-05 18:11:53,021 - test_ai_mock - INFO -   - The Hidden Semiconductor War in Africa (score: 7.80)
2025-06-05 18:11:53,021 - test_ai_mock - INFO -   - India's Quiet Energy Diplomacy in Central Asia (score: 7.20)
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Step 3: Testing prompt creation...
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Generated prompt length: 1176 characters
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Prompt preview:
2025-06-05 18:11:53,021 - test_ai_mock - INFO - You are a geopolitical analyst. Select 3 stories from:

1. Cluster ID: cluster_0
   Title: China's New Arctic Strategy Threatens NATO Supply Lines
   Source: Foreign Affairs (analysis)
   Summary: China is expanding its presence in the Arctic through infrastructure investments and partnerships with Russia, potentially threatening NATO's northern supply routes and creating new geopolitical vulnerabilities.
   Cluster size: 1 articles
   Score: 8.50
   

2. Cluster ID: cluster_1
   Title: The Hidd...
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Step 4: Creating mock AI analysis...
2025-06-05 18:11:53,021 - test_ai_mock - INFO - Created 2 mock analyses:
2025-06-05 18:11:53,021 - test_ai_mock - INFO -   - China's New Arctic Strategy Threatens NATO Supply Lines (impact: 8/10)
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     Why important: China's Arctic expansion creates new vulnerabilities for NATO's northern supply routes and challenge...
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     What overlooked: Mainstream media focuses on military aspects but misses the infrastructure and economic dimensions of China's Arctic strategy.
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     Prediction: Expect increased NATO Arctic exercises and new security partnerships with Nordic countries within 6 months.
2025-06-05 18:11:53,021 - test_ai_mock - INFO - 
2025-06-05 18:11:53,021 - test_ai_mock - INFO -   - The Hidden Semiconductor War in Africa (impact: 7/10)
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     Why important: Control of African rare earth minerals is becoming critical for semiconductor production, with major...
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     What overlooked: Focus on Asia-Pacific chip competition misses the crucial African mineral supply chain dimension.
2025-06-05 18:11:53,021 - test_ai_mock - INFO -     Prediction: Expect new Chinese and Western infrastructure deals in mineral-rich African nations.
2025-06-05 18:11:53,022 - test_ai_mock - INFO - 
2025-06-05 18:11:53,022 - test_ai_mock - INFO - === AI Analyzer Structure Test Complete ===
2025-06-05 18:15:23,709 - test_newsletter - INFO - === Testing Newsletter Generation ===
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 1: Creating mock AI analyses...
2025-06-05 18:15:23,709 - test_newsletter - INFO - Created 4 mock analyses
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 2: Initializing newsletter generator...
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 3: Generating newsletter object...
2025-06-05 18:15:23,709 - test_newsletter - INFO - Newsletter generated:
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Title: Geopolitical Daily
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Date: 2025-06-05
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Stories: 4
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Intro length: 447 characters
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 4: Generating HTML content...
2025-06-05 18:15:23,709 - test_newsletter - INFO - HTML generated:
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Content length: 12494 characters
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Contains title: True
2025-06-05 18:15:23,709 - test_newsletter - INFO -   - Contains stories: True
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 5: Saving HTML file...
2025-06-05 18:15:23,709 - test_newsletter - INFO - Newsletter saved to: /mnt/persist/workspace/output/test_newsletter.html
2025-06-05 18:15:23,709 - test_newsletter - INFO - File exists: True
2025-06-05 18:15:23,709 - test_newsletter - INFO - File size: 12494 bytes
2025-06-05 18:15:23,709 - test_newsletter - INFO - Step 6: Sample newsletter content:
2025-06-05 18:15:23,709 - test_newsletter - INFO - Stories included:
2025-06-05 18:15:23,709 - test_newsletter - INFO -   1. Turkey's Drone Diplomacy Reshapes Middle East Alliances (Impact: 9/10)
2025-06-05 18:15:23,710 - test_newsletter - INFO -      Why important: Turkey's military drone exports are creating new alliance patterns in the Middle East and Africa, gi...
2025-06-05 18:15:23,710 - test_newsletter - INFO -      What overlooked: Analysis focuses on individual conflicts but misses how drone diplomacy is systematically reshaping Turkey's strategic position across multiple regions.
2025-06-05 18:15:23,710 - test_newsletter - INFO - 
2025-06-05 18:15:23,710 - test_newsletter - INFO -   2. China's New Arctic Strategy Threatens NATO Supply Lines (Impact: 8/10)
2025-06-05 18:15:23,710 - test_newsletter - INFO -      Why important: China is expanding its presence in the Arctic through infrastructure investments and partnerships wi...
2025-06-05 18:15:23,710 - test_newsletter - INFO -      What overlooked: Mainstream media focuses on military aspects but misses the infrastructure and economic dimensions of China's long-term Arctic strategy.
2025-06-05 18:15:23,710 - test_newsletter - INFO - 
2025-06-05 18:15:23,710 - test_newsletter - INFO -   3. The Hidden Semiconductor War in Africa (Impact: 7/10)
2025-06-05 18:15:23,710 - test_newsletter - INFO -      Why important: Major powers are quietly competing for control of rare earth minerals in Africa essential for semico...
2025-06-05 18:15:23,710 - test_newsletter - INFO -      What overlooked: Focus on Asia-Pacific chip competition misses the crucial African mineral supply chain dimension that could determine technological sovereignty.
2025-06-05 18:15:23,710 - test_newsletter - INFO - 
2025-06-05 18:15:23,710 - test_newsletter - INFO -   4. India's Quiet Energy Diplomacy in Central Asia (Impact: 6/10)
2025-06-05 18:15:23,710 - test_newsletter - INFO -      Why important: India is building new energy partnerships in Central Asia that could reshape regional power dynamics...
2025-06-05 18:15:23,710 - test_newsletter - INFO -      What overlooked: Western analysis focuses on Russia-China competition but underestimates India's growing role as a third major power in Central Asian energy markets.
2025-06-05 18:15:23,710 - test_newsletter - INFO - 
2025-06-05 18:15:23,710 - test_newsletter - INFO - === Newsletter Generation Test Complete ===
2025-06-05 18:19:45,278 - test_complete_pipeline - INFO - === Testing Complete Newsletter Pipeline ===
2025-06-05 18:19:45,278 - test_complete_pipeline - INFO - Running in DRY_RUN mode (no real AI API calls)
2025-06-05 18:19:45,278 - main_pipeline - INFO - === Starting Geopolitical Daily Newsletter Pipeline ===
2025-06-05 18:19:45,278 - main_pipeline - INFO - Pipeline started at: 2025-06-05 18:19:45.278353
2025-06-05 18:19:45,278 - main_pipeline - INFO - Step 1: Validating configuration...
2025-06-05 18:19:45,278 - main_pipeline - ERROR - Missing configuration: ['ANTHROPIC_API_KEY', 'SUBSTACK_API_KEY', 'SUBSTACK_PUBLICATION_ID']
2025-06-05 18:19:45,278 - test_complete_pipeline - ERROR - ❌ Complete pipeline test FAILED!
2025-06-05 18:20:03,613 - test_complete_pipeline - INFO - === Testing Complete Newsletter Pipeline ===
2025-06-05 18:20:03,613 - test_complete_pipeline - INFO - Running in DRY_RUN mode (no real AI API calls)
2025-06-05 18:20:03,613 - main_pipeline - INFO - === Starting Geopolitical Daily Newsletter Pipeline ===
2025-06-05 18:20:03,613 - main_pipeline - INFO - Pipeline started at: 2025-06-05 18:20:03.613943
2025-06-05 18:20:03,614 - main_pipeline - INFO - Step 1: Validating configuration...
2025-06-05 18:20:03,614 - main_pipeline - INFO - Configuration validated successfully
2025-06-05 18:20:03,614 - main_pipeline - INFO - Step 2: Collecting articles from all sources...
2025-06-05 18:20:10,523 - main_pipeline - INFO - Collection completed: 481 articles
2025-06-05 18:20:10,524 - main_pipeline - INFO - Step 3: Processing articles...
2025-06-05 18:20:38,055 - main_pipeline - INFO - Processing completed: 453 clusters created
2025-06-05 18:20:38,055 - main_pipeline - INFO - Step 4: Skipping AI analysis (dry run mode)
2025-06-05 18:20:38,055 - main_pipeline - INFO - Step 5: Generating newsletter...
2025-06-05 18:20:38,056 - main_pipeline - INFO - Newsletter saved to: /mnt/persist/workspace/output/newsletter_20250605_182038.html
2025-06-05 18:20:38,056 - main_pipeline - INFO - Step 6: Skipping publishing (dry run mode)
2025-06-05 18:20:38,056 - main_pipeline - INFO - === Pipeline Summary ===
2025-06-05 18:20:38,056 - main_pipeline - INFO - Total execution time: 34.44 seconds
2025-06-05 18:20:38,056 - main_pipeline - INFO - Articles collected: 481
2025-06-05 18:20:38,056 - main_pipeline - INFO - Articles after processing: 474
2025-06-05 18:20:38,056 - main_pipeline - INFO - Clusters created: 453
2025-06-05 18:20:38,056 - main_pipeline - INFO - Stories selected: 4
2025-06-05 18:20:38,056 - main_pipeline - INFO - Newsletter file: /mnt/persist/workspace/output/newsletter_20250605_182038.html
2025-06-05 18:20:38,056 - main_pipeline - INFO - Success rate: 100.00%
2025-06-05 18:20:38,056 - main_pipeline - INFO - === Pipeline Completed Successfully ===
2025-06-05 18:20:38,056 - test_complete_pipeline - INFO - ✅ Complete pipeline test PASSED!
2025-06-05 18:20:38,057 - test_complete_pipeline - INFO - 📧 Latest newsletter: output/newsletter_20250605_182038.html
2025-06-05 18:20:38,057 - test_complete_pipeline - INFO - 📊 File size: 12269 bytes
